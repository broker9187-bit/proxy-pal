<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Proxy Pal</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; max-width:900px; margin:40px auto; padding:0 20px; }
    input[type=text] { width: 100%; padding:10px; font-size:16px; box-sizing:border-box; }
    .btn { margin-top:10px; padding:10px 14px; font-size:16px; }
    .small { color:#666; font-size:13px; margin-top:8px; }
  </style>
</head>
<body>
  <h1>Proxy Pal</h1>
  <p>Enter a URL and navigation will stay inside this site.</p>

  <form id="goForm" action="/proxy" method="get" autocomplete="off">
    <input id="urlInput" name="url" type="text" placeholder="https://example.com" />
    <button class="btn" type="submit">Go</button>
  </form>

  <p class="small">Tip: If your URL is missing a scheme, this page will add <code>https://</code>. If you want me to add a different landing page or a domain allowlist UI, tell me and Iâ€™ll produce it.</p>

  <script>
    (function () {
      const form = document.getElementById('goForm');
      const input = document.getElementById('urlInput');

      // If user pastes or types a URL without scheme, add https:// on submit
      function normalizeUrl(raw) {
        if (!raw) return '';
        raw = raw.trim();
        // If it looks like a URL but has no scheme, add https://
        if (/^[a-zA-Z][a-zA-Z0-9+.-]*:\/\//.test(raw)) {
          return raw;
        }
        // If it's just domain or starts with www.
        if (/^[\w.-]+\.[a-z]{2,}([\/?:].*)?$/i.test(raw) || raw.startsWith('www.')) {
          return 'https://' + raw;
        }
        return raw;
      }

      form.addEventListener('submit', function (e) {
        const normalized = normalizeUrl(input.value);
        // Put normalized value back into the input so the GET param is correct
        input.value = normalized;
        // allow form submit to proceed (same-tab navigation to /proxy?url=...)
      });

      // Optional: allow Ctrl+V normalization on paste
      input.addEventListener('paste', function (ev) {
        // small delay to let paste happen
        setTimeout(() => {
          input.value = normalizeUrl(input.value);
        }, 50);
      });

      // Optionally pre-fill from location query if returning from proxied page
      const qs = new URLSearchParams(location.search);
      if (qs.get('url')) {
        input.value = qs.get('url');
      }
    })();
  </script>
</body>
</html>
